/**
 * Responsive Luxury - Premium Mobile Experience
 * Mobile-first responsive design with refined breakpoints
 */

/* Arctic Sky Theme Responsive Adjustments */
.theme-arcticSky {
  --glass-blur: 15px;
  --transition-normal: 300ms cubic-bezier(0.4, 0, 0.2, 1);
}

/* Theme Card Responsive Adjustments */
@media (max-width: 768px) {
  .theme-cards-container {
    grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    gap: 0.5rem;
  }
  
  .theme-card {
    height: 90px;
  }
  
  .theme-preview {
    height: 50px;
  }
  
  .theme-name {
    font-size: clamp(0.5rem, 2vw, 0.7rem);
    padding: 0.25rem;
  }
}

@media (max-width: 480px) {
  .theme-cards-container {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.4rem;
  }
  
  .theme-card {
    height: 80px;
  }
  
  .theme-preview {
    height: 45px;
  }
  
  .theme-name {
    font-size: clamp(0.45rem, 1.8vw, 0.65rem);
    padding: 0.2rem;
  }
}

/* Mobile First Approach */
@media (max-width: 768px) {
  .app-container {
    padding: 2rem 1.5rem;
  }

  /* Make the Add button less tall and the plus icon bigger on mobile */
  /* Make submit button compact; input remains dominant */
  .add-task-form button[type="submit"].btn {
    width: 44px;
    height: 44px;
    min-width: 44px;
    min-height: 44px;
    padding: 0;                    /* pure icon button */
    display: inline-grid;
    place-items: center;
    border-radius: 12px;
    line-height: 1;
  }
  .add-task-form button[type="submit"].btn svg {
    width: 22px;                   /* readable but not oversized */
    height: 22px;
  }

  .app-title {
    font-size: 2.5rem;
  }

  .daily-quote {
    font-size: 1rem;
  }

  .task-input,
  .task-description-input {
    font-size: 1rem;
    padding: 0.875rem 1rem;
  }

  .btn {
    padding: 0.625rem 1.25rem;
    min-height: 44px;
    font-size: 0.875rem;
  }

  .filter-btn {
    padding: 0.75rem 1.5rem;
    min-height: 44px;
    font-size: 0.875rem;
  }


  .btn--floating {
    width: 56px;
    height: 56px;
  }

  .task-item {
    padding: 1.25rem;
    margin: 0.5rem 0;
  }

  .task-title {
    font-size: 1rem;
  }

  .task-description {
    font-size: 0.875rem;
  }

  .floating-controls {
    bottom: 1.5rem;
    right: 1.5rem;
    gap: 0.75rem;
  }

  .progress-panel,
  .settings-panel {
    width: 95%;
    max-width: none;
    left: 2.5%;
    right: 2.5%;
    transform: translateX(0);
  }

  /* Enhanced mobile settings panel */
  .settings-panel {
    width: 80%;
    max-height: 80vh;
    border-radius: var(--radius-xl);
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    touch-action: pan-y;
  }

  .settings-header .close-btn {
    width: 40px;
    height: 40px;
    font-size: 1.875rem;
  }
}

@media (max-width: 480px) {
  .app-container {
    padding: 1.5rem 1rem;
  }

  .app-title {
    font-size: 2rem;
  }

  .daily-quote {
    font-size: 0.9rem;
  }

  .task-input,
  .task-description-input {
    font-size: 0.875rem;
    padding: 0.75rem 0.875rem;
  }

  .btn {
    padding: 0.5rem 1rem;
    min-height: 40px;
    font-size: 0.875rem;
  }


  .btn--floating {
    width: 52px;
    height: 52px;
  }

  .btn--subtle {
    padding: 0.5rem 1rem;
    min-height: 40px;
    font-size: 0.875rem;
  }

  .task-item {
    padding: 1rem;
    flex-direction: column;
    align-items: stretch;
    gap: 1rem;
  }

  .task-content {
    flex-direction: column;
    align-items: stretch;
    gap: 1rem;
  }

  .task-actions {
    flex-direction: row;
    margin-left: 0;
    margin-top: 0.75rem;
    justify-content: flex-end;
  }

  .footer-actions {
    flex-direction: column;
    gap: 0.75rem;
  }

  .footer-actions .btn {
    width: 100%;
    padding: 0.625rem 1.25rem;
    min-height: 44px;
    font-size: 0.875rem;
  }

  .filter-group {
    flex-direction: column;
    align-items: stretch;
    gap: 0.5rem;
  }

  .progress-panel,
  .settings-panel {
    width: 100%;
    left: 0;
    right: 0;
    border-radius: var(--radius-2xl) var(--radius-2xl) 0 0;
  }

  .statistics-header .close-btn {
    width: 40px;
    height: 40px;
    font-size: 1.875rem;
  }
}

/* Tablet Optimization */
@media (min-width: 769px) and (max-width: 1024px) {
  .app-container {
    padding: 2.5rem 2rem;
  }

  .app-title {
    font-size: 3rem;
  }
}

/* Desktop Enhancement */
@media (min-width: 1025px) {
  .app-container {
    padding: 3.5rem 2.5rem;
  }

  .app-title {
    font-size: 4rem;
  }

  /* Keep input dominant and make submit button visually lighter on desktop */
  .add-task-form .input-container {
    display: grid;
    grid-template-columns: 1fr auto; /* input expands, button hugs */
    gap: 0.5rem;
    align-items: center;
  }
  .add-task-form button[type="submit"].btn {
    width: 40px;
    height: 40px;
    min-width: 40px;
    min-height: 40px;
    padding: 0;
    display: inline-grid;
    place-items: center;
    border-radius: 10px;
    line-height: 1;
  }
  .add-task-form button[type="submit"].btn .lucide-icon,
  .add-task-form button[type="submit"].btn svg {
    width: 20px;
    height: 20px;
  }
}

/* Ultra-wide Screens */
@media (min-width: 1440px) {
  .app-container {
    max-width: 900px;
    padding: 4rem 3rem;
  }
}

/* Floating Settings styles removed; CenterActionBar is the single source of truth */

/* Touch Targets Enhancement */
@media (hover: none) and (pointer: coarse) {

  .btn,
  .task-input,
  .task-description-input {
    min-height: 44px;
  }


  .btn--floating,
  .floating-btn {
    width: 56px;
    height: 56px;
  }
}

/* Safe Area Support */
@supports (padding: max(0px)) {
  .app-container {
    padding-left: max(2rem, env(safe-area-inset-left));
    padding-right: max(2rem, env(safe-area-inset-right));
  }

  .floating-controls {
    bottom: max(2rem, env(safe-area-inset-bottom));
    right: max(2rem, env(safe-area-inset-right));
  }
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }

  .nebula-bg {
    animation: none;
  }
}

/* High Contrast Mode */
@media (prefers-contrast: high) {
  :root {
    --glass-opacity: 0.95;
    --color-border: var(--color-text);
  }

  .glass {
    border-width: 2px;
  }
}

/* Print Styles */
@media print {

  .background-container,
  .floating-controls,
  .progress-panel,
  .settings-panel {
    display: none;
  }

  body {
    background: white;
    color: black;
  }
}

/* Mobile Touch Optimization */
.task-list-container {
  touch-action: pan-y;
  -webkit-overflow-scrolling: touch;
}

/* Removed legacy Mobile Unified Controls Cluster; CenterActionBar handles mobile too */

/* Extracted from index.html: Floating Actions (centered above footer) */
.floating-actions,
.center-action-bar {
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  bottom: 84px; /* sits above sticky footer */
  z-index: var(--z-floating-actions, 950);
  pointer-events: none; /* allow clicks through gap except on buttons */
}
.floating-actions .action-group,
.center-action-bar .action-group {
  display: inline-flex;
  flex-direction: row; /* ensure horizontal layout */
  align-items: center;
  gap: 12px;
  /* constrain glass effect within rounded pill */
  background: color-mix(in oklab, var(--color-glass) 75%, transparent);
  border: 1px solid var(--color-border);
  border-radius: 999px;
  padding: 8px 10px;
  backdrop-filter: blur(var(--glass-blur));
  -webkit-backdrop-filter: blur(var(--glass-blur));
  box-shadow: 0 8px 24px var(--shadow-color);
  pointer-events: auto;
  overflow: hidden; /* prevent blur bleed */
  isolation: isolate; /* create new stacking context */
  mask-composite: exclude;
  -webkit-mask-image: radial-gradient(circle, #000 99%, transparent 100%); /* WebKit containment assist */
}

.btn--floating-action {
  position: relative;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  display: grid;
  place-items: center;
  color: var(--color-text);
  background: color-mix(in oklab, var(--color-glass) 85%, transparent);
  border: 1px solid var(--color-border);
  transition: transform 140ms ease, filter 140ms ease, box-shadow 140ms ease, background 140ms ease;
  overflow: hidden; /* contain inner particles/glass */
  backdrop-filter: none; /* avoid per-button extra blur bleed */
  -webkit-backdrop-filter: none;
}
.center-action-bar .btn--floating-action {
  width: var(--btn-size-primary, 44px);
  height: var(--btn-size-primary, 44px);
}
.btn--floating-action:hover {
  transform: translateY(-1px);
  filter: brightness(1.05);
}
.btn--floating-action:active {
  transform: translateY(0);
  filter: brightness(0.98);
}

/* Particle field and micro-anim */
.particle-field {
  position: absolute;
  inset: 0;
  overflow: hidden;
  pointer-events: none;
}
.particle {
  position: absolute;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: linear-gradient(90deg, var(--accent-color), var(--glow-color));
  transform: translate(-50%, -50%);
  animation: particle-pop 600ms ease-out forwards;
  box-shadow: 0 0 8px var(--glow-color);
}
@keyframes particle-pop {
  0% { opacity: 1; transform: translate(-50%, -50%) scale(0.2); }
  70% { opacity: 1; transform: translate(calc(-50% + var(--tx)), calc(-50% + var(--ty))) scale(1); }
  100% { opacity: 0; transform: translate(calc(-50% + var(--tx)), calc(-50% + var(--ty))) scale(1); }
}

/* Deprecated centered floating actions on mobile (replaced by bottom-right cluster) */
@media (max-width: 768px) {
  /* Hide legacy floating actions on mobile, but keep CenterActionBar visible */
  .floating-actions:not(.center-action-bar) { display: none !important; }

  /* CenterActionBar spec: mobile top-center below safe area notch */
  .center-action-bar {
    display: block !important;
    top: calc(env(safe-area-inset-top, 0px) + 12px);
    bottom: auto;
    transform: translateX(-50%);
    opacity: 1;                 /* ensure visible */
    pointer-events: auto;
  }

  /* Add extra top space so the header ('Luxury Todo') sits below the center bar */
  .app-container {
    /* push content down by the bar height + breathing room */
    padding-top: calc(40px + env(safe-area-inset-top, 0px));
  }

  /* If header has its own margins, ensure they don't collapse upwards */
  .app-header {
    margin-top: 0.5rem;
  }
}

/* Horizontal pill layout: keep subgroups inline to ensure a single-row bar */
.center-action-bar .action-subgroup {
  display: inline-flex;
  flex-direction: row;
  align-items: center;
  gap: 8px;
}

/* Vertical separator for CenterActionBar groups */
.center-action-bar .vertical-separator {
  align-self: stretch;
  width: 1px;
  height: auto; /* stretch to group height */
  background: var(--color-border-soft, color-mix(in oklab, var(--color-border) 50%, transparent));
  margin: 0 12px;
  opacity: 0.4;
}

/* Ensure all scrollable areas can scroll properly */
@media (max-width: 768px) {
  /* Hide legacy right-side floating-controls on mobile (we will use a unified mobile cluster) */
  .floating-controls {
    display: none;
  }
  
  /* Ensure settings panel is visible on mobile */
  .settings-panel {
    display: block !important;
  }
}

/* Desktop: remove legacy bottom-right floating-controls (keep top-right floating-settings only) */
@media (min-width: 1025px) {
  .floating-controls {
    display: none !important;
  }
}

/* Prevent touch conflicts on mobile */
@media (hover: none) and (pointer: coarse) {
  .task-item {
    touch-action: pan-y;
  }
  
  /* Allow vertical scrolling without interference */
  .task-list-container {
    touch-action: pan-y;
  }
  
  /* Ensure settings panel is visible on touch devices */
  .settings-panel {
    display: block !important;
  }
}


  /* If header has its own margins, ensure they don't collapse upwards */
  .app-header {
    margin-top: 0.5rem;
  }
}

/* Horizontal pill layout: keep subgroups inline to ensure a single-row bar */
.center-action-bar .action-subgroup {
  display: inline-flex;
  flex-direction: row;
  align-items: center;
  gap: 8px;
}

/* Vertical separator for CenterActionBar groups */
.center-action-bar .vertical-separator {
  align-self: stretch;
  width: 1px;
  height: auto; /* stretch to group height */
  background: var(--color-border-soft, color-mix(in oklab, var(--color-border) 50%, transparent));
  margin: 0 12px;
  opacity: 0.4;
}

/* Ensure all scrollable areas can scroll properly */
@media (max-width: 768px) {
  /* Hide legacy right-side floating-controls on mobile (we will use a unified mobile cluster) */
  .floating-controls {
    display: none;
  }
  
  /* Ensure settings panel is visible on mobile */
  .settings-panel {
    display: block !important;
  }
}

/* Desktop: remove legacy bottom-right floating-controls (keep top-right floating-settings only) */
@media (min-width: 1025px) {
  .floating-controls {
    display: none !important;
  }
}

/* Prevent touch conflicts on mobile */
@media (hover: none) and (pointer: coarse) {
  .task-item {
    touch-action: pan-y;
  }
  
  /* Allow vertical scrolling without interference */
  .task-list-container {
    touch-action: pan-y;
  }
  
  /* Ensure settings panel is visible on touch devices */
  .settings-panel {
    display: block !important;
  }
}
